# pay_explore

调研背景：

1. 应用需要添加vip服务功能。iOS端，可选方案对应平台所需酬金不一，且用户体验会有差距。
2. iOS端需额外遵循Apple的应用内支付的规则。
3. 当前调研App Store上提供VIP服务支付方式，以下app所用都是IAP(苹果内购)：【腾讯，优酷|土豆，爱奇艺，暴风影音，PP视频，搜狐视频，风行视频，乐视视频】。**未发现提供有vip服务并提供IAP之外的支付方式的视频app。**

* [App Store 审核指南:](https://developer.apple.com/cn/app-store/review/guidelines/)

    **"如果您想要在 app 内解锁特性或功能 (解锁方式有：订阅、游戏内货币、游戏关卡、优质内容的访问权限或解锁完整版等)，则必须使用 App 内购买项目。"**





#### 支付方案拟定风险评估

##### 1. 使用苹果内购（IAP）
> Apple支持的内购方式。
> vip收费功能属于虚拟服务，Apple审核支付规则中明确说明，必须使用内购(IAP)。
> 用户必须注册iTunes账号并充值才能完成支付

###### 产品注意事项：
1. 友好的支付信息界面、告知用户支付规则等讯息。
2. 付款项目遵守Apple内购规则: [In-App Purchase](https://developer.apple.com/in-app-purchase/)

###### 功能接入时长评估：
1. 收费规则设计及iTunes相关厂商关联  预估1周
2. 客户端vip入口交互和设计，客户端实现  5个工作日。
3. 功能技术端IAP功能接入及沙盒测试（IAP详细文档研究+对应IPA接入） 4个工作日。
4. QA测试评估及问题修复上下支持 2~4个工作日。

> 初步预估总的开发时长为20个工作日。其中第一条具有不确定性。而2、3、4需基于1的完成。




##### 2. 使用跳转web页面支付
> 存在被拒审和下架风险。
> 避免直接在应用中使用到第三方支付框架，提审被Apple发现违规风险较小。

###### 产品注意事项：
1. 谨防各种下架因素:
    a. 避免Apple审查处违规元素，譬如工程中关键字(pay)、应用界面元素（支付入口）等。
    b. 用户举报。
2. 处理好网页支付订单请求及回调规则。

###### 功能接入时长评估：
1. 收费规则设计相关厂商关联(微信|支付宝)，预估1周+
2. 客户端vip入口交互和设计，客户端实现  4个工作日。
3. 功能技术端实现，a.包括web端支付方式接入及联调，b. web端与应用native联调开发， 预估时长8个工作日。
4. QA测试评估及问题修复上下支持 2~4个工作日。

> 初步预估总的开发时长为 23个工作日。其中第一条具有不确定性。而2、3、4需基于1的完成。




##### 3. 接入第三方库(微信|支付宝)
> 被拒审和下架几率极大。
> 根据调研参考，Apple会对交互界面等，代码关键字，schemeURL等进行检查，发现应用有违审核条例中付款规则即会被拒和下架。

###### 产品注意事项：
1. 谨防各种下架因素:
    a. 避免Apple审查处违规元素，譬如工程三方库核查、应用界面元素（支付入口）等。
    b. 用户举报。
2. 遵循第三方产品支付规则。

###### 功能接入时长评估：
1. 收费规则设计相关厂商关联(微信|支付宝)，预估1周+
2. 客户端vip入口交互和设计,防审被拒控制设计，客户端实现  5个工作日。
3. 功能技术端实现， a.交互界面开发 b. 第三方支付接入 c.前后端联调， 预估时长10个工作日。
4. QA测试评估及问题修复上下支持 3~5个工作日。

> 初步预估总的开发时长为 27个工作日。其中第一条具有不确定性。而2、3、4需基于1的完成。



##### 4. 总结
1. 视频收费vip服务属于订阅虚拟物一类，按照Apple的标准，所用支付手段必须是内购，原则上不支持任何第三方支付方式。如果用户订阅初始一年apple收取30%的税务费用，一年以后为25%，即方案1。

2. 功能接入周期评估，方案1有多家产品可做参考，接入技术实现相对直接无风险，耗时较短。 

3. 对于方案2和方案3：
    a. 为规避Apple审查，需要对应用内交互代码等多方面做开关屏蔽处理，是延长开发周期的一个点。
    b. 当前应用尚无支付功能，将此方案2或3的功能提交审核存在审核被拒的风险。
    c. 这种方式实质上是利用对Apple隐瞒支付手段，过审前后均存在被查知的风险，这是目前最大的弊端。
    

#### 补充
1. 现有市场上视频应用类app,本次调研找到提供vip服务的使用的都是Apple的IAP支付方式。从此处可以侧面印证采用方案2、3的风险很大。
2. 从技术上来说，三种方案均有成熟的功能实现技术支撑。而作为首次接入无过往经验的情况，需要着重注意点在于产品流程设计、文档研究。事关用户money，尤其需要严谨。


#### reference 
##### 1. 官方文档
1. [微信第三方支付接入官方文档](http://kf.qq.com/faq/170116MvIvei170116m2AbUb.html) 
2. [支付宝alipay接入参考文档](https://docs.open.alipay.com/204)
3. [苹果内部支付IAP接入文档](https://developer.apple.com/in-app-purchase/)
4. [App Store 审核指南](https://developer.apple.com/cn/app-store/review/guidelines/)



